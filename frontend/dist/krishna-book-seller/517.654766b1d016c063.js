"use strict";(self.webpackChunkkrishna_book_seller=self.webpackChunkkrishna_book_seller||[]).push([[517],{3517:(tn,O,p)=>{p.r(O),p.d(O,{InvoiceModule:()=>nn});var _=p(9808),r=p(2382),Z=p(1293),u=p(5439),n=p(1223),C=p(9783),v=p(8921),x=p(8354),b=p(7489),m=p(4641),y=p(8493);m.vfs=y.I.vfs;let M=(()=>{class c{buildTableBody(t,e,o){const i=[];return i.push(e),t.forEach(a=>{let s=[];o.forEach(h=>{s.push(a[h.text])}),i.push(s)}),i}leftTable(t,e,o){return{style:"tableDataDetails",table:{widths:["auto","*","*","*"],body:this.buildTableBody(t,e,o)}}}rightTable(t,e,o){return{style:"tableDataDetailsright",table:{widths:["auto","*","*","*"],body:this.buildTableBody(t,e,o)}}}getClassNo(t,e){let o="";return t.forEach(i=>{i.name==e&&(o=i.value)}),o}generatePdf(t,e,o,i){let a={pageOrientation:"landscape",content:[{style:"maintableStyle",layout:"noBorders",table:{widths:["*","*"],body:[[{text:"Krishna Book Seller",style:"topheader",alignment:"center"},{text:"Krishna Book Seller",style:"topheader",alignment:"center"}],[{text:"Ramana, Muzaffarpur-842002",style:"address",alignment:"center"},{text:"Ramana, Muzaffarpur-842002",style:"address",alignment:"center"}],[{text:"Receipt",bold:!0,style:"invoice",alignment:"center"},{text:"Receipt",bold:!0,style:"invoice",alignment:"center"}],[{style:"basicdetails",layout:"noBorders",table:{widths:["*","auto"],body:[["Name:  "+(null!=t&&t.name?null==t?void 0:t.name:""),"Bill No:  "+(null!=t&&t.bill_no?null==t?void 0:t.bill_no:"")],["Father's Name:  "+(null!=t&&t.fatherName?null==t?void 0:t.fatherName:""),"Class:  "+(null!=t&&t.stdClass?this.getClassNo(o,null==t?void 0:t.stdClass):"")],["Mobile No:  "+(null!=t&&t.mobileNum?null==t?void 0:t.mobileNum:""),"Bill Date:  "+u(e).format("DD-MM-YYYY")],["Address:  "+(null!=t&&t.address?null==t?void 0:t.address:""),""]]}},{style:"basicdetailsright",layout:"noBorders",table:{widths:["*","auto"],body:[["Name:  "+(null!=t&&t.name?null==t?void 0:t.name:""),"Bill No:  "+(null!=t&&t.bill_no?null==t?void 0:t.bill_no:"")],["Father's Name:  "+(null!=t&&t.fatherName?null==t?void 0:t.fatherName:""),"Class:  "+(null!=t&&t.stdClass?this.getClassNo(o,null==t?void 0:t.stdClass):"")],["Mobile No:  "+(null!=t&&t.mobileNum?null==t?void 0:t.mobileNum:""),"Bill Date:  "+u(e).format("DD-MM-YYYY")],["Address:  "+(null!=t&&t.address?null==t?void 0:t.address:""),""]]}}],[this.leftTable(t.billParticulars,[{text:"Particulars",bold:!0},{text:"Rate",bold:!0},{text:"Quantity",bold:!0},{text:"Amount (\u20b9)",bold:!0}],[{text:"name",bold:!0},{text:"mrp",bold:!0},{text:"quantity",bold:!0},{text:"amount",bold:!0}]),this.rightTable(t.billParticulars,[{text:"Particulars",bold:!0},{text:"Rate",bold:!0},{text:"Quantity",bold:!0},{text:"Amount (\u20b9)",bold:!0}],[{text:"name",bold:!0},{text:"mrp",bold:!0},{text:"quantity",bold:!0},{text:"amount",bold:!0}])],[{text:"Total Amount (\u20b9):  "+(null!=t&&t.totalAmount?null==t?void 0:t.totalAmount:""),style:"totalAmt"},{text:"Total Amount (\u20b9):  "+(null!=t&&t.totalAmount?null==t?void 0:t.totalAmount:""),style:"totalAmt"}],[{text:"Authorised Signatory",bold:!0,margin:[0,5,25,10],alignment:"right",fontSize:10},{text:"Authorised Signatory",bold:!0,margin:[0,5,25,10],alignment:"right",fontSize:10}],[{text:"SP Note.",bold:!0,margin:[0,5,15,0],fontSize:8},{text:"SP Note.",bold:!0,margin:[15,3,0,0],fontSize:8}],[{text:"1. Book once distributed will not be exchanged or returned under any circumstances.",style:"spnoteDetails"},{text:"1. Book once distributed will not be exchanged or returned under any circumstances.",style:"spnoteDetailsright"}],[{text:"2. Bill should be kept very carefully and should not be misplaced under any circumstances.",style:"spnoteDetails"},{text:"2. Bill should be kept very carefully and should not be misplaced under any circumstances.",style:"spnoteDetailsright"}],[{text:"3. All books must be checked at the counter itself at the time of delivery.No complains will be entertained later on.",fontSize:7,style:"spnoteDetails"},{text:"3. All books must be checked at the counter itself at the time of delivery.No complains will be entertained later on.",style:"spnoteDetailsright"}]]}}],styles:{topheader:{fontSize:12,alignment:"center",bold:!0,margin:[0,0,0,0],screenLeft:100},address:{fontSize:8,alignment:"center"},invoice:{fontSize:10,bold:!0,margin:[0,0,0,4],alignment:"center"},basicdetails:{margin:[0,0,15,10],fontSize:9},basicdetailsright:{margin:[15,0,0,10],fontSize:9},maintableStyle:{margin:[0,0,0,10],fontSize:9},totalAmt:{margin:[0,0,25,8],alignment:"right",bold:!0,fontSize:10},tableDataDetails:{fontSize:8,margin:[0,0,15,10]},tableDataDetailsright:{fontSize:8,margin:[15,0,0,10]},spnoteDetails:{fontSize:7,margin:[0,0,15,0]},spnoteDetailsright:{fontSize:7,margin:[15,0,0,0]},upperCase:{TextDecoder:b.upperCase}}};const s=window.open("","_blank");if("print"==i)m.createPdf(a).print({},s);else{const h="invoice "+u(e).format("DD-MMM-YYYY")+".pdf";m.createPdf(a).download(h)}}}return c.\u0275fac=function(t){return new(t||c)},c.\u0275prov=n.Yz7({token:c,factory:c.\u0275fac}),c})();var T=p(9019),I=p(520);let f=(()=>{class c{constructor(t){this.http=t,this.URL=T.N.baseUrl}saveInvoice(t){const e=JSON.parse(JSON.stringify(t));return t.invoiceId?(delete e.invoiceId,this.http.put(this.URL+`/billing/invoice/${t.invoiceId}`,e)):this.http.post(this.URL+"/billing/invoice",t)}searchInvoice(t){return this.http.get(this.URL+"/billing/search",{params:t})}getBookList(t){return this.http.get(this.URL+`/book/class/${t}`)}getInvoiceDetails(t){return this.http.get(this.URL+`/billing/invoice/${t}`)}serachInvoiceByBillNo(t){return this.http.get(this.URL+`/billing/search/${t.billId}`)}deleteInvoice(t){const e={headers:new I.WM({"Content-Type":"application/json"}),body:t};return this.http.delete(this.URL+"/billing/delete-invoice",e)}getInvoiceNo(t){return this.http.get(this.URL+"/billing/bill-num")}}return c.\u0275fac=function(t){return new(t||c)(n.LFG(I.eN))},c.\u0275prov=n.Yz7({token:c,factory:c.\u0275fac}),c})();var A=p(845),w=p(5652),P=p(4471);function B(c,l){1&c&&(n.ynx(0),n.TgZ(1,"div",28),n._UZ(2,"img",29),n.TgZ(3,"p",30),n._uU(4,"please search by date or Bill no"),n.qZA()(),n.BQk())}function N(c,l){1&c&&(n.TgZ(0,"tr")(1,"th",35),n._uU(2,"Bill No "),n._UZ(3,"p-sortIcon",36),n.qZA(),n.TgZ(4,"th",37),n._uU(5,"Name "),n._UZ(6,"p-sortIcon",38),n.qZA(),n.TgZ(7,"th",39),n._uU(8,"Father Name "),n._UZ(9,"p-sortIcon",40),n.qZA(),n.TgZ(10,"th",41),n._uU(11,"Class"),n._UZ(12,"p-sortIcon",42),n.qZA(),n.TgZ(13,"th",43),n._uU(14,"Total Amount (\u20b9)"),n._UZ(15,"p-sortIcon",44),n.qZA(),n.TgZ(16,"th",45),n._uU(17,"Action"),n.qZA()())}function S(c,l){if(1&c){const t=n.EpF();n.TgZ(0,"tr",46)(1,"td")(2,"span",47),n._uU(3,"id"),n.qZA(),n._uU(4),n.qZA(),n.TgZ(5,"td")(6,"span",47),n._uU(7,"name"),n.qZA(),n.TgZ(8,"span",48),n._uU(9),n.qZA()(),n.TgZ(10,"td")(11,"span",47),n._uU(12,"father_name"),n.qZA(),n.TgZ(13,"span",48),n._uU(14),n.qZA()(),n.TgZ(15,"td")(16,"span",47),n._uU(17,"class"),n.qZA(),n._uU(18),n.qZA(),n.TgZ(19,"td")(20,"span",47),n._uU(21,"total_amount"),n.qZA(),n._uU(22),n.qZA(),n.TgZ(23,"td",49)(24,"button",50),n.NdJ("click",function(){const i=n.CHM(t).$implicit,a=n.oxw(2);return n.KtG(a.updateInvoice(i.invoice_id))}),n.qZA(),n.TgZ(25,"button",51),n.NdJ("click",function(){const i=n.CHM(t).$implicit,a=n.oxw(2);return n.KtG(a.generatePdf("download",i))}),n.qZA(),n.TgZ(26,"button",52),n.NdJ("click",function(){const i=n.CHM(t).$implicit,a=n.oxw(2);return n.KtG(a.generatePdf("print",i))}),n.qZA(),n.TgZ(27,"button",53),n.NdJ("click",function(){const i=n.CHM(t).$implicit,a=n.oxw(2);return n.KtG(a.openConfirmationDialog(i.invoice_id))}),n.qZA()()()}if(2&c){const t=l.$implicit;n.xp6(4),n.hij(" ",t.id," "),n.xp6(5),n.Oqu(t.name),n.xp6(5),n.Oqu(t.father_name),n.xp6(4),n.hij(" ",null==t?null:t.class_no," "),n.xp6(4),n.hij(" ",t.total_amount," ")}}function q(c,l){1&c&&(n.TgZ(0,"tr")(1,"td",54),n._uU(2,"No Data found."),n.qZA()())}const U=function(){return[10,25,50]};function L(c,l){if(1&c&&(n.ynx(0),n.TgZ(1,"p-table",31),n.YNc(2,N,18,0,"ng-template",32),n.YNc(3,S,28,5,"ng-template",33),n.YNc(4,q,3,0,"ng-template",34),n.qZA(),n.BQk()),2&c){const t=n.oxw();n.xp6(1),n.Q6J("value",t.invoiceList)("rowHover",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",n.DdM(7,U))("loading",t.loading)("paginator",!0)}}let F=(()=>{class c{constructor(t,e,o,i,a){this.messageService=t,this.router=e,this.confirmationDialogService=o,this.invoicePrintService=i,this.invoiceService=a,this.invoiceList=[],this.loading=!1,this.billLoading=!1,this.dateLoading=!1,this.searchInvoice=!1,this.deleteLoader=!1,this.todayDate=new Date,this.fromDateValue=new Date,this.toDateValue=new Date,this.billId="",this.billingDate=new Date,this.searchBy="billid",this.classList=[{id:1,name:"infant",value:"Infant"},{id:2,name:"nursery",value:"Nursery"},{id:3,name:"prep",value:"Prep"},{id:4,name:"one",value:"1"},{id:5,name:"two",value:"2"},{id:6,name:"three",value:"3"},{id:7,name:"four",value:"4"},{id:8,name:"five",value:"5"},{id:9,name:"six",value:"6"},{id:10,name:"seven",value:"7"},{id:11,name:"eight",value:"8"},{id:12,name:"nine",value:"9"},{id:13,name:"ten",value:"10"},{id:14,name:"eleven",value:"11"},{id:14,name:"twelve",value:"12"}]}ngOnInit(){}onSearch(){this.loading=!0;const t={};t.from=u(this.fromDateValue).format("YYYY-MM-DD"),t.to=u(this.toDateValue).format("YYYY-MM-DD"),this.invoiceService.searchInvoice(t).subscribe({next:e=>{this.invoiceList=[],e&&e.data&&(e.data.invoice.forEach(o=>{o.class_no=this.getClassNo(this.classList,o.class)}),this.invoiceList=e.data.invoice)},error:e=>{this.loading=!1,this.searchInvoice=!0,this.billLoading=!1,this.dateLoading=!1},complete:()=>{this.loading=!1,this.searchInvoice=!0,this.billLoading=!1,this.dateLoading=!1}})}onSearchByBillid(){if(!this.billId)return;this.loading=!0;const t={};t.billId=this.billId,this.invoiceList=[],this.invoiceService.serachInvoiceByBillNo(t).subscribe({next:e=>{e&&e.data&&(e.data.forEach(o=>{o.class_no=this.getClassNo(this.classList,o.class)}),this.invoiceList=e.data)},error:e=>{this.loading=!1,this.searchInvoice=!0,this.billLoading=!1,this.dateLoading=!1},complete:()=>{this.loading=!1,this.searchInvoice=!0,this.billLoading=!1,this.dateLoading=!1}})}resetSearch(t){"bill"==t?this.billId="":(this.fromDateValue="",this.toDateValue="")}getClassNo(t,e){let o="";return t.forEach(i=>{i.name==e&&(o=i.value)}),o}updateInvoice(t){this.router.navigate(["invoice/update-invoice",t])}openConfirmationDialog(t){this.confirmationDialogService.confirm("Confirmation","Are you sure you want delete?","Okay","Cancel","danger","secondary").then(e=>{console.log("User confirmed:",e),e&&this.deleteInvoice(t)}).catch(()=>{console.log("User dismissed the dialog (e.g., by using ESC, clicking the cross icon, or clicking outside the dialog)")})}deleteInvoice(t){const e=[];e.push(t);const o={};o.invoiceId=e,this.invoiceService.deleteInvoice(o).subscribe({next:i=>{i&&i.message&&(this.invoiceList=this.invoiceList.filter(a=>a.invoice_id!==t))},error:i=>{},complete:()=>{}})}generatePdf(t,e){this.invoiceDetails=[];let o={};this.invoiceService.getInvoiceDetails(e.invoice_id).subscribe(i=>{var a;if(i&&i.data&&i.data.length>0){this.invoiceDetails=i.data[0];const s={},h=[];s.name=this.invoiceDetails&&this.invoiceDetails.name?this.invoiceDetails.name.toUpperCase():"",s.stdClass=this.invoiceDetails.class,s.fatherName=this.invoiceDetails&&this.invoiceDetails.father_name?this.invoiceDetails.father_name.toUpperCase():"",s.totalAmount=this.invoiceDetails.total_amount,s.address=this.invoiceDetails&&this.invoiceDetails.address?this.invoiceDetails.address.toUpperCase():"",s.bill_no=this.invoiceDetails.id,s.mobileNum=this.invoiceDetails.mobile_num?this.invoiceDetails.mobile_num:"",null===(a=this.invoiceDetails)||void 0===a||a.bill_data.forEach(d=>{const g={};g.id=d.id,g.name=d.name,g.amount=d.amount,g.class=d.class,g.year=d.year,g.publication_id=d.publication_id,g.mrp=d.mrp,g.net_price=d.net_price,g.quantity=d.quantity?Number(d.quantity):"",h.push(g)}),s.billParticulars=h,o=s,this.invoicePrintService.generatePdf(o,this.billingDate,this.classList,t)}})}}return c.\u0275fac=function(t){return new(t||c)(n.Y36(C.ez),n.Y36(v.F0),n.Y36(x.O),n.Y36(M),n.Y36(f))},c.\u0275cmp=n.Xpm({type:c,selectors:[["app-search-invoice"]],decls:48,vars:15,consts:[[1,"content-wrapper"],[1,"content-heading"],[1,"content-details","flex"],[1,"search-content","flex"],[1,"search-Bill"],[1,"search-bill-type","flex"],[1,"search-by"],["id","mysel",1,"search","select-drop",3,"ngModel","ngModelChange","change"],["value","billid"],["value","seachBy"],[1,"search-details","flex"],[1,"search-bill-No","flex"],["for","bill"],["id","bill",3,"type","ngModel","ngModelChange"],[1,"content-btn","flex"],["type","button",1,"btn-search","button",3,"disabled","click"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm",3,"hidden"],["type","button",1,"btn-reset","button",3,"click"],[1,"content-field"],[1,"search-date-field","flex"],[1,"search-date"],["for","From"],["inputId","From","dateFormat","dd/mm/yy","placeholder","dd/mm/yyyy",3,"ngModel","showIcon","ngModelChange"],[1,"search-date","serch-left"],["for","To"],["inputId","To","dateFormat","dd/mm/yy","placeholder","dd/mm/yyyy",3,"ngModel","minDate","showIcon","ngModelChange"],[1,"table-responsive"],[4,"ngIf"],[1,"select-type","flex"],["src","assets/img/document.svg"],[1,"msg-type"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","styleClass","p-datatable-customers",3,"value","rowHover","rows","showCurrentPageReport","rowsPerPageOptions","loading","paginator"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pSortableColumn","id"],["field","id"],["pSortableColumn","name"],["field","name"],["pSortableColumn","father_name"],["field","father_name"],["pSortableColumn","class_no"],["field","class_no"],["pSortableColumn","total_amount"],["field","total_amount"],[2,"width","10rem","text-align","center"],[1,"p-selectable-row"],[1,"p-column-title"],[1,"image-text"],[2,"width","10rem"],["pButton","","type","button","icon","pi pi-pencil",1,"secondary",3,"click"],["pButton","","type","button","icon","pi pi-download",1,"secondary",3,"click"],["pButton","","type","button","icon","pi pi-print",1,"secondary",3,"click"],["pButton","","type","button","icon","pi pi-trash",1,"danger",3,"click"],["colspan","8",2,"text-align","center"]],template:function(t,e){1&t&&(n.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h5"),n._uU(4,"Search Invoice"),n.qZA()(),n.TgZ(5,"div",3)(6,"div",4)(7,"div",5)(8,"p",6),n._uU(9,"Search By Bill No."),n.qZA(),n.TgZ(10,"select",7),n.NdJ("ngModelChange",function(i){return e.searchBy=i})("change",function(){return e.billId=""}),n.TgZ(11,"option",8),n._uU(12,"Search By Bill No"),n.qZA(),n.TgZ(13,"option",9),n._uU(14,"Search By Name"),n.qZA()()(),n.TgZ(15,"div",10)(16,"div",11)(17,"label",12),n._uU(18),n.qZA(),n.TgZ(19,"input",13),n.NdJ("ngModelChange",function(i){return e.billId=i}),n.qZA()(),n.TgZ(20,"div",14)(21,"button",15),n.NdJ("click",function(){return e.onSearchByBillid(),e.billLoading=!0}),n._uU(22,"Search "),n._UZ(23,"span",16),n.qZA(),n.TgZ(24,"button",17),n.NdJ("click",function(){return e.resetSearch("bill")}),n._uU(25,"Reset "),n.qZA()()()(),n.TgZ(26,"div",18)(27,"p",6),n._uU(28,"Search By Date"),n.qZA(),n.TgZ(29,"div",10)(30,"div",19)(31,"div",20)(32,"label",21),n._uU(33,"From"),n.qZA(),n.TgZ(34,"p-calendar",22),n.NdJ("ngModelChange",function(i){return e.fromDateValue=i}),n.qZA()(),n.TgZ(35,"div",23)(36,"label",24),n._uU(37,"To"),n.qZA(),n.TgZ(38,"p-calendar",25),n.NdJ("ngModelChange",function(i){return e.toDateValue=i}),n.qZA()()(),n.TgZ(39,"div",14)(40,"button",15),n.NdJ("click",function(){return e.onSearch(),e.dateLoading=!0,e.billId=""}),n._uU(41,"Search "),n._UZ(42,"span",16),n.qZA(),n.TgZ(43,"button",17),n.NdJ("click",function(){return e.resetSearch()}),n._uU(44,"Reset "),n.qZA()()()()()(),n.TgZ(45,"div",26),n.YNc(46,B,5,0,"ng-container",27),n.YNc(47,L,5,8,"ng-container",27),n.qZA()()),2&t&&(n.xp6(10),n.Q6J("ngModel",e.searchBy),n.xp6(8),n.Oqu("billid"==e.searchBy?"Bill No":"Name"),n.xp6(1),n.s9C("type","billid"==e.searchBy?"number":"text"),n.Q6J("ngModel",e.billId),n.xp6(2),n.Q6J("disabled",!e.billId),n.xp6(2),n.Q6J("hidden",!e.billLoading),n.xp6(11),n.Q6J("ngModel",e.fromDateValue)("showIcon",!0),n.xp6(4),n.Q6J("ngModel",e.toDateValue)("minDate",e.fromDateValue)("showIcon",!0),n.xp6(2),n.Q6J("disabled",""==e.fromDateValue||""==e.toDateValue),n.xp6(2),n.Q6J("hidden",!e.dateLoading),n.xp6(4),n.Q6J("ngIf",!e.searchInvoice),n.xp6(1),n.Q6J("ngIf",e.searchInvoice))},dependencies:[_.O5,r.YN,r.Kr,r.Fj,r.EJ,r.JJ,r.On,A.Hq,w.f,C.jx,P.iA,P.lQ,P.fz],styles:[".content-wrapper[_ngcontent-%COMP%]{padding:8px 19px}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .content-details[_ngcontent-%COMP%]{flex-direction:column;justify-content:center;align-items:center}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .content-details[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{padding:10px}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]{padding:20px 10px;justify-content:space-between}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]{width:60%}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .search-by[_ngcontent-%COMP%]{color:#000;font-weight:600}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .search-details[_ngcontent-%COMP%]{flex-direction:column}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .search-details[_ngcontent-%COMP%]   .search-date-field[_ngcontent-%COMP%]   .search-date[_ngcontent-%COMP%]{padding:28px 0}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .search-details[_ngcontent-%COMP%]   .search-date-field[_ngcontent-%COMP%]   .search-date[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{padding-right:30px;width:50px;color:gray}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .search-details[_ngcontent-%COMP%]   .search-date-field[_ngcontent-%COMP%]   .search-date[_ngcontent-%COMP%]     .p-datepicker table td{padding:.4rem!important}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .search-details[_ngcontent-%COMP%]   .search-date-field[_ngcontent-%COMP%]   .search-date[_ngcontent-%COMP%]     .p-datepicker table td>span{width:1.5rem!important;height:1.5rem!important}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .search-details[_ngcontent-%COMP%]   .search-date-field[_ngcontent-%COMP%]   .search-date[_ngcontent-%COMP%]     .ui-calendar .ui-datepicker{height:200px!important}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .search-details[_ngcontent-%COMP%]   .search-date-field[_ngcontent-%COMP%]   .search-date[_ngcontent-%COMP%]     .p-button.p-button-icon-only{height:40px}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .search-details[_ngcontent-%COMP%]   .search-date-field[_ngcontent-%COMP%]   .search-date[_ngcontent-%COMP%]     .p-calendar .p-inputtext{height:40px}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .search-details[_ngcontent-%COMP%]   .search-date-field[_ngcontent-%COMP%]   .search-date.serch-left[_ngcontent-%COMP%]{margin-left:30px}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .search-details[_ngcontent-%COMP%]   .content-btn[_ngcontent-%COMP%]{justify-content:center}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .search-details[_ngcontent-%COMP%]   .content-btn[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{border:none;width:100px;background-color:#000;color:#fff;text-align:center;padding:8px;background-color:#6c757d}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .search-details[_ngcontent-%COMP%]   .content-btn[_ngcontent-%COMP%]   .button.btn-search[_ngcontent-%COMP%]{background-color:#2563eb}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .search-details[_ngcontent-%COMP%]   .content-btn[_ngcontent-%COMP%]   .button.btn-reset[_ngcontent-%COMP%]{margin-left:135px}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .search-details[_ngcontent-%COMP%]   .content-btn[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:disabled{opacity:.6}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .search-Bill[_ngcontent-%COMP%]{width:40%}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .search-Bill[_ngcontent-%COMP%]   .search-bill-type[_ngcontent-%COMP%]   .search-by[_ngcontent-%COMP%]{color:#000;font-weight:600}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .search-Bill[_ngcontent-%COMP%]   .search-bill-type[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{outline:0;width:245px;height:40px;line-height:15px;background:#fff;border:solid 1px #dfdfdf;border-radius:2px;margin-left:6%}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .search-Bill[_ngcontent-%COMP%]   .search-details[_ngcontent-%COMP%]{flex-direction:column}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .search-Bill[_ngcontent-%COMP%]   .search-details[_ngcontent-%COMP%]   .search-bill-No[_ngcontent-%COMP%]{padding:28px 0}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .search-Bill[_ngcontent-%COMP%]   .search-details[_ngcontent-%COMP%]   .search-bill-No[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{padding-right:30px;color:gray;width:90px}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .search-Bill[_ngcontent-%COMP%]   .search-details[_ngcontent-%COMP%]   .search-bill-No[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:250px;height:40px;border:solid 1px #e8e8e8;padding:0 13px;font-style:normal}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .search-Bill[_ngcontent-%COMP%]   .search-details[_ngcontent-%COMP%]   .search-bill-No[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled{background:#fff;opacity:.7}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .search-Bill[_ngcontent-%COMP%]   .search-details[_ngcontent-%COMP%]   .content-btn[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:none;width:100px;background-color:#000;color:#fff;text-align:center;padding:8px;background-color:#6c757d}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .search-Bill[_ngcontent-%COMP%]   .search-details[_ngcontent-%COMP%]   .content-btn[_ngcontent-%COMP%]   button.btn-search[_ngcontent-%COMP%]{background-color:#2563eb}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .search-Bill[_ngcontent-%COMP%]   .search-details[_ngcontent-%COMP%]   .content-btn[_ngcontent-%COMP%]   button.btn-reset[_ngcontent-%COMP%]{margin-left:135px}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .search-content[_ngcontent-%COMP%]   .search-Bill[_ngcontent-%COMP%]   .search-details[_ngcontent-%COMP%]   .content-btn[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.6}.content-wrapper[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]{padding:20px 0}.content-wrapper[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]   .p-button.p-button-icon-only[_ngcontent-%COMP%]{width:2rem;padding:.5rem 0}.content-wrapper[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]     .p-datatable.p-datatable-customers .p-datatable-header{padding:1rem;text-align:left;font-size:1.5rem}.content-wrapper[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]     .p-datatable.p-datatable-customers .p-paginator{padding:1rem;align-items:flex-end;justify-content:flex-end}.content-wrapper[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]     .p-datatable.p-datatable-customers .p-datatable-thead>tr>th{padding:12px}.content-wrapper[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]     .p-datatable.p-datatable-customers .p-datatable-tbody>tr>td{padding:6px 0 5px 15px!important}.content-wrapper[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]     .p-datatable.p-datatable-customers .p-button.p-button-icon-only{width:2rem;padding:.5rem 0}.content-wrapper[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]     .p-datatable.p-datatable-customers .p-button:enabled:hover{background:none;color:#000;border-color:#000;outline:none!important}.content-wrapper[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]     .p-datatable.p-datatable-customers .p-button{color:#000;background:none;border:none;outline:none!important}.content-wrapper[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]     .p-datatable.p-datatable-customers .p-dropdown-label:not(.p-placeholder){text-transform:uppercase}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}"]}),c})();var J=p(3770),Y=p(605);function D(c,l){1&c&&(n.TgZ(0,"div",22),n._uU(1,"Name is required"),n.qZA())}function Q(c,l){1&c&&(n.TgZ(0,"div",22),n._uU(1,"Father Name is required"),n.qZA())}function z(c,l){if(1&c&&(n.ynx(0),n.TgZ(1,"option",23),n._uU(2),n.qZA(),n.BQk()),2&c){const t=l.$implicit;n.xp6(1),n.Q6J("value",t.name),n.xp6(1),n.Oqu(t.value)}}function E(c,l){1&c&&(n.TgZ(0,"div",22),n._uU(1,"Class is required"),n.qZA())}function R(c,l){1&c&&(n.TgZ(0,"div",24),n._UZ(1,"img",25),n.TgZ(2,"p",26),n._uU(3,"please select class"),n.qZA()())}function V(c,l){1&c&&(n.TgZ(0,"div",27),n._UZ(1,"app-loader"),n.qZA())}function j(c,l){if(1&c){const t=n.EpF();n.TgZ(0,"div",43)(1,"button",44),n.NdJ("click",function(){n.CHM(t);const o=n.oxw(2);return n.KtG(o.printInvoice("print"))}),n._uU(2,"Print"),n.qZA()()}}function $(c,l){1&c&&(n.TgZ(0,"tr")(1,"td",45)(2,"p",46),n._uU(3,"No Data found"),n.qZA()()())}function K(c,l){if(1&c){const t=n.EpF();n.ynx(0),n.TgZ(1,"tr")(2,"td")(3,"input",47),n.NdJ("change",function(o){n.CHM(t);const i=n.oxw().$implicit,a=n.oxw(2);return n.KtG(a.onSelectBook(o,i))}),n.qZA(),n._UZ(4,"label",48),n.qZA(),n.TgZ(5,"td"),n._uU(6),n.qZA(),n.TgZ(7,"td",49)(8,"input",50),n.NdJ("ngModelChange",function(o){n.CHM(t);const i=n.oxw().$implicit;return n.KtG(i.mrp=o)}),n.qZA()(),n.TgZ(9,"td",49)(10,"input",51),n.NdJ("ngModelChange",function(o){n.CHM(t);const i=n.oxw().$implicit;return n.KtG(i.quantity=o)}),n.qZA()(),n.TgZ(11,"td",49)(12,"input",52),n.NdJ("ngModelChange",function(o){n.CHM(t);const i=n.oxw().$implicit;return n.KtG(i.amount=o)}),n.qZA()()(),n.BQk()}if(2&c){const t=n.oxw().$implicit,e=n.oxw(2);n.xp6(3),n.s9C("id",t.id),n.Q6J("checked",e.selectedBookIds.indexOf(t.id)>-1),n.xp6(1),n.s9C("for",t.id),n.xp6(2),n.Oqu(t.name),n.xp6(2),n.Q6J("ngModel",t.mrp),n.xp6(2),n.Q6J("ngModel",t.quantity),n.xp6(2),n.Q6J("value",e.calculatedAmount(t.mrp,t.quantity,t))("ngModel",t.amount)}}function G(c,l){if(1&c&&(n.ynx(0),n.YNc(1,K,13,8,"ng-container",21),n.BQk()),2&c){const t=l.$implicit;n.xp6(1),n.Q6J("ngIf",0!==t.quantity)}}function H(c,l){if(1&c){const t=n.EpF();n.ynx(0),n.YNc(1,j,3,0,"div",28),n.TgZ(2,"div",29)(3,"table",30)(4,"thead")(5,"tr"),n._UZ(6,"th",31),n.TgZ(7,"th",32),n._uU(8,"Particulars"),n.qZA(),n.TgZ(9,"th",33),n._uU(10,"Rate"),n.qZA(),n.TgZ(11,"th",34),n._uU(12,"Qty"),n.qZA(),n.TgZ(13,"th",35),n._uU(14,"Amount (\u20b9)"),n.qZA()()(),n.TgZ(15,"tbody"),n.YNc(16,$,4,0,"tr",21),n.YNc(17,G,2,1,"ng-container",12),n.qZA()(),n.TgZ(18,"div",36)(19,"div",37)(20,"button",38),n.NdJ("click",function(){n.CHM(t);const o=n.oxw();return n.KtG(o.onSaveConfirmation())}),n._uU(21),n._UZ(22,"span",39),n.qZA(),n.TgZ(23,"button",40),n.NdJ("click",function(){n.CHM(t);const o=n.oxw();return n.KtG(o.cancel())}),n._uU(24,"Cancel"),n.qZA()(),n.TgZ(25,"div",41)(26,"p"),n._uU(27,"Total Amount (\u20b9)"),n.qZA(),n.TgZ(28,"input",42),n.NdJ("ngModelChange",function(o){n.CHM(t);const i=n.oxw();return n.KtG(i.totalInvoiceAmount=o)}),n.qZA()()()(),n.BQk()}if(2&c){const t=n.oxw();n.xp6(1),n.Q6J("ngIf",t.classId&&t.showPrint),n.xp6(15),n.Q6J("ngIf",0===t.bookList.length),n.xp6(1),n.Q6J("ngForOf",t.bookList),n.xp6(4),n.hij("",t.invoiceId?"Update":"Save"," "),n.xp6(1),n.Q6J("hidden",!t.submitLoader),n.xp6(6),n.Q6J("ngModel",t.totalInvoiceAmount)}}m.vfs=y.I.vfs;let k=(()=>{class c{constructor(t,e,o,i,a,s,h){this.fb=t,this.cdr=e,this.confirmationDialogService=o,this.invoiceService=i,this.route=a,this.invoicePrintService=s,this.messageService=h,this.bookList=[],this.selectedBook=[],this.selectedBookIds=[],this.totalInvoiceAmount="",this.submitLoader=!1,this.intialPageLoader=!1,this.showPrint=!1,this.billingDate=new Date,this.subscriptions={},this.selectedBookListByid={},this.previousSelectedBook=[],this.errorMessage="",this.classList=[{id:1,name:"infant",value:"Infant"},{id:2,name:"nursery",value:"Nursery"},{id:3,name:"prep",value:"Prep"},{id:4,name:"one",value:"1"},{id:5,name:"two",value:"2"},{id:6,name:"three",value:"3"},{id:7,name:"four",value:"4"},{id:8,name:"five",value:"5"},{id:9,name:"six",value:"6"},{id:10,name:"seven",value:"7"},{id:11,name:"eight",value:"8"},{id:12,name:"nine",value:"9"},{id:13,name:"ten",value:"10"},{id:14,name:"eleven",value:"11"},{id:14,name:"twelve",value:"12"}]}ngOnInit(){this.initForm(),this.getRouteParams()}getRouteParams(){this.sub=this.route.params.subscribe(t=>{console.log("params",t),this.invoiceId="",t&&t.id?(this.invoiceId=t.id,this.intialPageLoader=!0,this.getInvoiceDetails(this.invoiceId)):this.getInvoiceNumber()})}getInvoiceNumber(){this.subscriptions.getInvoiceNumber=this.invoiceService.getInvoiceNo({}).subscribe(t=>{t&&t.data&&this.invoiceForm.controls.billno.setValue(t.data[0])})}ngAfterContentChecked(){this.cdr.detectChanges()}initForm(){this.invoiceForm=this.fb.group({name:["",[r.kI.required]],billno:[""],fathername:["",[r.kI.required]],mobno:[""],classno:["",[r.kI.required]],date:["",[r.kI.required]],address:[""]}),this.invoiceForm.controls.billno.disable(),this.invoiceForm.controls.date.disable()}onSaveConfirmation(){this.invoiceForm.valid?0!==this.selectedBook.length?this.openConfirmationDialog():this.messageService.add({severity:"error",summary:"Error",detail:"atLeast Select one book"}):this.validateAllFormFields(this.invoiceForm)}SaveInvoice(){this.errorMessage="";const t=this.invoiceForm.getRawValue(),e={};let o=[];this.selectedBook.forEach(i=>{if(i.quantity&&i.amount){const a={};a.id=i.id,a.name=i.name,a.amount=i.amount,a.class=i.class,a.year=i.year,a.publication_id=i.publication_id,a.mrp=i.mrp,a.net_price=i.net_price,a.quantity=i.quantity?Number(i.quantity):"",o.push(a)}}),this.submitLoader=!0,e.name=t.name,e.stdClass=t.classno,e.fatherName=t.fathername,e.totalAmount=this.totalInvoiceAmount,t.mobno&&(e.mobileNum=t.mobno),t.address&&(e.address=t.address),e.billParticulars=o,this.invoiceId&&(e.invoiceId=this.invoiceId?this.invoiceId:"",e.previousBillParticulars=this.previousSelectedBook),this.printData={},this.subscriptions.saveInvoice=this.invoiceService.saveInvoice(e).subscribe({next:i=>{i&&i.message&&(!this.invoiceId&&i.data&&i.data[0]&&(this.saveInvoiceId=i.data[0]),this.submitLoader=!1,this.showPrint=!0,this.printData=e,this.printData.bill_no=t.billno?t.billno:"")},error:i=>{var a;console.log("error",i.error),this.errorMessage=null===(a=null==i?void 0:i.error)||void 0===a?void 0:a.message,this.submitLoader=!1}})}cancel(){this.selectedBook=[],this.selectedBookIds=[],this.totalInvoiceAmount="",this.showPrint=!1,this.invoiceId?this.getInvoiceDetails(this.invoiceId):(this.invoiceForm.controls.name.reset(),this.invoiceForm.controls.fathername.reset(),this.invoiceForm.controls.mobno.reset(),this.invoiceForm.controls.address.reset(),this.invoiceForm.controls.classno.reset(),this.classId="",this.getInvoiceNumber())}resetparticularField(){this.bookList.forEach(t=>{this.selectedBookIds.indexOf(t.id)>-1&&(t.quantity="1",t.amount="")})}onChangeClass(t){this.intialPageLoader=!0,this.classId=t.value,this.errorMessage="",this.subscriptions.bookList=this.invoiceService.getBookList(this.classId).subscribe(e=>{this.intialPageLoader=!1,this.bookList=[],this.selectedBookIds=[],this.selectedBook=[],e&&e.data&&(e.data.forEach(o=>{o.quantity="1",o.amount="",this.selectedBookIds.push(o.id)}),this.bookList=e.data,this.selectedBook=e.data)}),this.resetparticularField(),setTimeout(()=>{this.selectedBook=[],this.selectedBookIds=[],this.totalInvoiceAmount="",this.showPrint=!1},10)}onSelectBook(t,e){const o=this.selectedBookIds.indexOf(e.id);o>-1?(this.selectedBook=this.selectedBook.filter(i=>i.id!==e.id),this.selectedBookIds.splice(o,1)):(this.selectedBook.push(e),this.selectedBookIds.push(e.id))}calculatedAmount(t,e,o){if(this.invoiceId&&t&&e&&this.selectedBook.length>0&&this.selectedBook.forEach(i=>{i.id===o.id&&(i.quantity=e,i.amount=(Number(e)*parseFloat(i.mrp)).toFixed(2))}),t&&e){const a=(parseFloat(t)*e).toFixed(2);return this.bookList.forEach(s=>{s.id===o.id&&(s.amount=a)}),this.totalAmount(),a}return""}totalAmount(){let e=0;this.selectedBook.length>0?(this.selectedBook.forEach(o=>{if(o.mrp&&o.quantity&&o.amount){const i=parseFloat(o.amount);e+=i}}),this.totalInvoiceAmount=parseFloat(e).toFixed(2)):this.totalInvoiceAmount=""}validateAllFormFields(t){Object.keys(t.controls).forEach(e=>{const o=t.get(e);o instanceof r.NI?o.markAsTouched({onlySelf:!0}):o instanceof r.cw&&this.validateAllFormFields(o)})}openConfirmationDialog(){this.confirmationDialogService.confirm("Confirmation",`Are you sure you want to ${this.invoiceId?"Update":"Save"} Invoice!`,"Okay","Cancel","primary","secondary").then(t=>{console.log("User confirmed:",t),t&&this.SaveInvoice()}).catch(()=>{console.log("User dismissed the dialog (e.g., by using ESC, clicking the cross icon, or clicking outside the dialog)")})}getInvoiceDetails(t){this.selectedBookIds=[],this.selectedBook=[],this.previousClassId="",this.previousSelectedBook=[],this.subscriptions.invoiceDetails=this.invoiceService.getInvoiceDetails(t).subscribe(e=>{e&&e.data&&e.data.length>0&&(this.invoiceDetails=e.data[0],this.selectedBookListByid=(0,b.groupBy)(this.invoiceDetails.bill_data,"id"),this.getBookList(this.invoiceDetails.class),this.classId=this.invoiceDetails.class,this.previousClassId=this.invoiceDetails.class,this.invoiceForm.controls.name.setValue(this.invoiceDetails.name),this.invoiceForm.controls.billno.setValue(this.invoiceDetails.id),this.invoiceForm.controls.fathername.setValue(this.invoiceDetails.father_name),this.invoiceForm.controls.mobno.setValue(this.invoiceDetails.mobile_num),this.invoiceForm.controls.classno.setValue(this.invoiceDetails.class),this.invoiceForm.controls.address.setValue(this.invoiceDetails.address),this.billingDate=new Date(this.invoiceDetails.date),this.invoiceDetails&&this.invoiceDetails.bill_data&&this.invoiceDetails.bill_data.forEach(o=>{this.selectedBookIds.push(o.id),this.selectedBook.push({id:o.id,name:o.name,amount:o.amount,class:o.class,year:o.year,publication_id:o.publication_id,net_price:o.net_price,quantity:o.quantity,mrp:o.mrp}),this.previousSelectedBook.push({id:o.id,quantity:o.quantity})}))})}getBookList(t){this.subscriptions.bookListdata=this.invoiceService.getBookList(t).subscribe(e=>{this.intialPageLoader=!1,e&&e.data&&(e.data.forEach(o=>{o.quantity="1",this.selectedBookListByid&&this.selectedBookListByid[o.id]&&(o.quantity=this.selectedBookListByid[o.id].length>0?this.selectedBookListByid[o.id][0].quantity:"1",o.amount=this.selectedBookListByid[o.id].length>0?this.selectedBookListByid[o.id][0].amount:"")}),this.bookList=e.data)})}printInvoice(t){this.generatePdf(t,this.invoiceId?this.invoiceId:this.saveInvoiceId)}generatePdf(t,e){this.invoiceDetails=[];let o={};this.invoiceService.getInvoiceDetails(e).subscribe(i=>{var a;if(i&&i.data&&i.data.length>0){this.invoiceDetails=i.data[0];const s={},h=[];s.name=this.invoiceDetails&&this.invoiceDetails.name?this.invoiceDetails.name.toUpperCase():"",s.stdClass=this.invoiceDetails.class,s.fatherName=this.invoiceDetails&&this.invoiceDetails.father_name?this.invoiceDetails.father_name.toUpperCase():"",s.totalAmount=this.invoiceDetails.total_amount,s.address=this.invoiceDetails&&this.invoiceDetails.address?this.invoiceDetails.address.toUpperCase():"",s.bill_no=this.invoiceDetails.id,s.mobileNum=this.invoiceDetails.mobile_num?this.invoiceDetails.mobile_num:"",null===(a=this.invoiceDetails)||void 0===a||a.bill_data.forEach(d=>{const g={};g.id=d.id,g.name=d.name,g.amount=d.amount,g.class=d.class,g.year=d.year,g.publication_id=d.publication_id,g.mrp=d.mrp,g.net_price=d.net_price,g.quantity=d.quantity?Number(d.quantity):"",h.push(g)}),s.billParticulars=h,o=s,this.invoicePrintService.generatePdf(o,this.billingDate,this.classList,t)}})}ngOnDestroy(){(0,b.each)(this.subscriptions,t=>{t.unsubscribe()})}}return c.\u0275fac=function(t){return new(t||c)(n.Y36(r.qu),n.Y36(n.sBO),n.Y36(x.O),n.Y36(f),n.Y36(v.gz),n.Y36(M),n.Y36(C.ez))},c.\u0275cmp=n.Xpm({type:c,selectors:[["app-invoice"]],decls:45,vars:12,consts:[[1,"content-wrapper"],[1,"content-heading"],[1,"content-details","flex"],[3,"formGroup"],[1,"content-field","flex"],[1,"input-field"],["type","text","formControlName","name",2,"text-transform","uppercase"],["class","error-data position-error",4,"ngIf"],["type","text","formControlName","billno"],["type","text","formControlName","fathername",2,"text-transform","uppercase"],["type","text","appOnlyNumber","","numericType","number","formControlName","mobno"],["id","mysel","formControlName","classno",1,"search","select-drop",3,"change"],[4,"ngFor","ngForOf"],["for","To"],["inputId","To","dateFormat","dd/mm/yy","placeholder","dd/mm/yyyy","formControlName","date",3,"ngModel","showIcon","ngModelChange"],[1,"input-field","flex"],["type","text","formControlName","address",2,"text-transform","uppercase"],["class","select-type flex",4,"ngIf"],["class","intial-loader",4,"ngIf"],[1,"error-msg","flex"],[1,"error-data"],[4,"ngIf"],[1,"error-data","position-error"],[3,"value"],[1,"select-type","flex"],["src","assets/img/document.svg"],[1,"msg-type"],[1,"intial-loader"],["class","report-print flex",4,"ngIf"],[1,"table-responsive","inv-adm-tbl"],[1,"table"],[1,"inv-check"],[1,"inv-particular","text-center"],[1,"inv-rate","text-center"],[1,"inv-qty","text-center"],[1,"inv-amt","text-center"],[1,"content-btn-details","flex"],[1,"content-btn","flex"],["type","button",1,"btn-save","button",3,"click"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm",3,"hidden"],["type","button",1,"btn-cancel","button",3,"click"],[1,"total-amt","flex"],["type","text","disabled","",1,"total-amt",3,"ngModel","ngModelChange"],[1,"report-print","flex"],["type","button",1,"btn-search","button",3,"click"],["height","250","colspan","5",2,"text-align","center","vertical-align","middle","background","white"],[2,"margin-top","20px"],["type","checkbox",1,"checkbox-custom",3,"id","checked","change"],[1,"checkbox-custom-label",3,"for"],[1,"text-center"],["type","text","disabled","","appOnlyNumber","","numericType","decimal",3,"ngModel","ngModelChange"],["type","text","appOnlyNumber","","numericType","number",3,"ngModel","ngModelChange"],["type","text","disabled","","appOnlyNumber","","numericType","decimal",3,"value","ngModel","ngModelChange"]],template:function(t,e){1&t&&(n.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h5"),n._uU(4),n.qZA()(),n.TgZ(5,"form",3)(6,"div",4)(7,"div",5)(8,"label"),n._uU(9,"Name"),n.qZA(),n._UZ(10,"input",6),n.YNc(11,D,2,0,"div",7),n.qZA(),n.TgZ(12,"div",5)(13,"label"),n._uU(14,"Bill No"),n.qZA(),n._UZ(15,"input",8),n.qZA(),n.TgZ(16,"div",5)(17,"label"),n._uU(18,"Father's Name"),n.qZA(),n._UZ(19,"input",9),n.YNc(20,Q,2,0,"div",7),n.qZA(),n.TgZ(21,"div",5)(22,"label"),n._uU(23,"Mob. No"),n.qZA(),n._UZ(24,"input",10),n.qZA(),n.TgZ(25,"div",5)(26,"label"),n._uU(27,"Class"),n.qZA(),n.TgZ(28,"select",11),n.NdJ("change",function(i){return e.onChangeClass(i.target)}),n.YNc(29,z,3,2,"ng-container",12),n.qZA(),n.YNc(30,E,2,0,"div",7),n.qZA(),n.TgZ(31,"div",5)(32,"label",13),n._uU(33,"Date"),n.qZA(),n.TgZ(34,"p-calendar",14),n.NdJ("ngModelChange",function(i){return e.billingDate=i}),n.qZA()(),n.TgZ(35,"div",15)(36,"label"),n._uU(37,"Address"),n.qZA(),n._UZ(38,"input",16),n.qZA()()()(),n.YNc(39,R,4,0,"div",17),n.YNc(40,V,2,0,"div",18),n.TgZ(41,"div",19)(42,"p",20),n._uU(43),n.qZA()(),n.YNc(44,H,29,6,"ng-container",21),n.qZA()),2&t&&(n.xp6(4),n.hij("",e.invoiceId?"Update":"Generate"," Invoice"),n.xp6(1),n.Q6J("formGroup",e.invoiceForm),n.xp6(6),n.Q6J("ngIf",e.invoiceForm.controls.name.hasError("required")&&e.invoiceForm.controls.name.touched),n.xp6(9),n.Q6J("ngIf",e.invoiceForm.controls.fathername.hasError("required")&&e.invoiceForm.controls.fathername.touched),n.xp6(9),n.Q6J("ngForOf",e.classList),n.xp6(1),n.Q6J("ngIf",e.invoiceForm.controls.classno.hasError("required")&&e.invoiceForm.controls.classno.touched),n.xp6(4),n.Q6J("ngModel",e.billingDate)("showIcon",!1),n.xp6(5),n.Q6J("ngIf",!e.classId),n.xp6(1),n.Q6J("ngIf",e.intialPageLoader&&e.classId),n.xp6(3),n.Oqu(e.errorMessage),n.xp6(1),n.Q6J("ngIf",e.classId&&e.bookList.length>0))},dependencies:[_.sg,_.O5,r._Y,r.YN,r.Kr,r.Fj,r.EJ,r.JJ,r.JL,r.On,r.sg,r.u,w.f,J.p,Y.R],styles:['.content-wrapper[_ngcontent-%COMP%]{padding:8px 19px}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .content-details[_ngcontent-%COMP%]{flex-direction:column;justify-content:center;align-items:center}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .content-details[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{padding:10px}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]{margin-top:15px}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .input-field[_ngcontent-%COMP%]{width:49%;padding:5px}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .input-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:25%;color:gray}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .input-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:65%;height:40px;border:solid 1px #e8e8e8;padding:0 13px;font-style:normal}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .input-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled{background:#ffffff;opacity:.8}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .input-field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:65%;height:75px;border:solid 1px #e8e8e8;padding:0 13px;font-style:normal}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .input-field[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{outline:0;width:65%;height:40px;line-height:15px;background:#fff;border:solid 1px #dfdfdf}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .input-field[_ngcontent-%COMP%]     .p-datepicker table td{padding:.4rem!important}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .input-field[_ngcontent-%COMP%]     .p-datepicker table td>span{width:1.5rem!important;height:1.5rem!important}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .input-field[_ngcontent-%COMP%]     .ui-calendar .ui-datepicker{height:200px!important}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .input-field[_ngcontent-%COMP%]     .p-button.p-button-icon-only{height:40px}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .input-field[_ngcontent-%COMP%]     .p-calendar .p-inputtext{height:40px}.content-wrapper[_ngcontent-%COMP%]   .content-heading[_ngcontent-%COMP%]   .content-field[_ngcontent-%COMP%]   .input-field[_ngcontent-%COMP%]     .p-calendar{width:65%}.content-wrapper[_ngcontent-%COMP%]   .inv-adm-tbl[_ngcontent-%COMP%]{padding:0 0 20px}.content-wrapper[_ngcontent-%COMP%]   .inv-adm-tbl[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]{width:100%}.content-wrapper[_ngcontent-%COMP%]   .inv-adm-tbl[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:14px;font-weight:600;font-family:sans-serif;color:#222426;vertical-align:top}.content-wrapper[_ngcontent-%COMP%]   .inv-adm-tbl[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th.inv-check[_ngcontent-%COMP%]{width:5%}.content-wrapper[_ngcontent-%COMP%]   .inv-adm-tbl[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th.inv-particular[_ngcontent-%COMP%]{width:50%}.content-wrapper[_ngcontent-%COMP%]   .inv-adm-tbl[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th.inv-rate[_ngcontent-%COMP%], .content-wrapper[_ngcontent-%COMP%]   .inv-adm-tbl[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th.inv-qty[_ngcontent-%COMP%], .content-wrapper[_ngcontent-%COMP%]   .inv-adm-tbl[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th.inv-amt[_ngcontent-%COMP%]{width:10%}.content-wrapper[_ngcontent-%COMP%]   .inv-adm-tbl[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background:white;font-size:14px;color:#000;padding:10px;vertical-align:middle}.content-wrapper[_ngcontent-%COMP%]   .inv-adm-tbl[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:80%;height:35px;border:solid 1px #e8e8e8;padding:0 4px;font-style:normal}.content-wrapper[_ngcontent-%COMP%]   .inv-adm-tbl[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .checkbox-custom[_ngcontent-%COMP%]{display:none}.content-wrapper[_ngcontent-%COMP%]   .inv-adm-tbl[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .checkbox-custom-label[_ngcontent-%COMP%]{display:inline-block;position:relative;vertical-align:middle;margin:5px;cursor:pointer}.content-wrapper[_ngcontent-%COMP%]   .inv-adm-tbl[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .checkbox-custom-label[_ngcontent-%COMP%]:before{display:inline-block;position:relative;vertical-align:middle;margin:5px;cursor:pointer}.content-wrapper[_ngcontent-%COMP%]   .inv-adm-tbl[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .checkbox-custom[_ngcontent-%COMP%] + .checkbox-custom-label[_ngcontent-%COMP%]:before{content:"";background:#fff;border-radius:2px;border:2px solid rgba(73,80,87,.6509803922);display:inline-block;vertical-align:middle;width:20px;height:20px;padding:2px}.content-wrapper[_ngcontent-%COMP%]   .inv-adm-tbl[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .checkbox-custom[_ngcontent-%COMP%]:checked + .checkbox-custom-label[_ngcontent-%COMP%]:before{background:#0d6efd;border:1px solid #bfdbfe}.content-wrapper[_ngcontent-%COMP%]   .inv-adm-tbl[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .checkbox-custom[_ngcontent-%COMP%]:checked + .checkbox-custom-label[_ngcontent-%COMP%]:after{content:"";padding:2px;position:absolute;width:1px;height:17px;border:solid #fff;border-width:0 3px 3px 0;transform:rotate(45deg);top:5px;left:12px}.content-wrapper[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]   .content-btn-details[_ngcontent-%COMP%]   .content-btn[_ngcontent-%COMP%]{width:77%;padding:0 40px 0 5px;justify-content:flex-end}.content-wrapper[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]   .content-btn-details[_ngcontent-%COMP%]   .content-btn[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{border:none;width:100px;background-color:#000;color:#fff;text-align:center;padding:8px;margin:0 0 0 30px}.content-wrapper[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]   .content-btn-details[_ngcontent-%COMP%]   .content-btn[_ngcontent-%COMP%]   .button.btn-save[_ngcontent-%COMP%]{background-color:#007bff}.content-wrapper[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]   .content-btn-details[_ngcontent-%COMP%]   .content-btn[_ngcontent-%COMP%]   .button.btn-cancel[_ngcontent-%COMP%]{background-color:#6c757d}.content-wrapper[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]   .content-btn-details[_ngcontent-%COMP%]   .content-btn[_ngcontent-%COMP%]   .button.btn-delete[_ngcontent-%COMP%]{background-color:#e24c4c}.content-wrapper[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]   .content-btn-details[_ngcontent-%COMP%]   .content-btn[_ngcontent-%COMP%]   .button.btn-update[_ngcontent-%COMP%]{background-color:#0dcaf0}.content-wrapper[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]   .content-btn-details[_ngcontent-%COMP%]   .content-btn[_ngcontent-%COMP%]   .button.btn-print[_ngcontent-%COMP%]{background-color:#007bff}.content-wrapper[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]   .content-btn-details[_ngcontent-%COMP%]   .total-amt[_ngcontent-%COMP%]{width:22%}.content-wrapper[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]   .content-btn-details[_ngcontent-%COMP%]   .total-amt[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:5px 10px}.content-wrapper[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]   .content-btn-details[_ngcontent-%COMP%]   .total-amt[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:40%;height:35px;border:solid 1px #e8e8e8;padding:0 4px;font-style:normal;background:#ffffff;opacity:.8}.content-wrapper[_ngcontent-%COMP%]   .select-type[_ngcontent-%COMP%]{justify-content:center;align-items:center;flex-direction:column;min-height:300px;background:white}.content-wrapper[_ngcontent-%COMP%]   .select-type[_ngcontent-%COMP%]   .msg-type[_ngcontent-%COMP%]{font-weight:500;padding-top:10px}.container-search[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{padding:6px;margin-top:8px;font-size:17px;width:40%;border:1px solid #e8e8e8}.container-search[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{float:right;padding:6px 10px;margin-top:8px;margin-right:16px;background:#ddd;font-size:17px;border:none;cursor:pointer}.container-search[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#ccc}.error-msg[_ngcontent-%COMP%]{justify-content:flex-start;margin-top:15px}.report-print[_ngcontent-%COMP%]{justify-content:flex-end;margin-top:10px;padding-bottom:10px}.report-print[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{border:none;color:#fff;text-align:center;padding:8px 25px;background-color:#2563eb}.report-print[_ngcontent-%COMP%]   .button.btn-reset[_ngcontent-%COMP%]{background-color:#6c757d}.position-error[_ngcontent-%COMP%]{padding-left:25%}']}),c})();const W=v.Bz.forChild([{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:k},{path:"search-invoice",component:F},{path:"update-invoice/:id",component:k}]);let nn=(()=>{class c{}return c.\u0275fac=function(t){return new(t||c)},c.\u0275mod=n.oAB({type:c}),c.\u0275inj=n.cJS({providers:[f,M],imports:[_.ez,r.u5,r.UX,Z.m,W]}),c})()}}]);